---
title: "Basic Example"
author: "Fiorella Sandoval"
date: "2025-10-01"
output: 
  github_document: default
  html_document: default
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_format = "all") })
editor_options: 
  markdown: 
    wrap: 72
---
#La Tarea esta en la línea 199

# Librerias

```{r librerias}
library(ggplot2)
library(dplyr)
```

# Letura de datos

```{r}
data_path <- file.path("C:/Users/Family2/Documents/4SEMESTRE/Estadistica_IV/UNIDAD_1/020_Tarea")
data_file <- file.path(data_path, "vgsales.csv")
data.vg.raw <- read.csv(data_file,
                 stringsAsFactors = F,na.strings = ".",header = T,sep=",")
head(data.vg.raw)
str(data.vg.raw)
```

# Limpieza de datos

```{r}
data.vg <- data.vg.raw 
data.vg$Platform <- factor(data.vg$Platform)
data.vg$Year <- as.numeric(data.vg$Year)
summary(data.vg)
```

```{r}
str(data.vg.raw)
unique(data.vg.raw$Year)
head(filter(data.vg.raw, Year=="N/A"))

```

```{r}
unique(data.vg$Platform)
filter(data.vg, Name=="FIFA 15")
hist(data.vg$NA_Sales )
```

Calculemos la proporcion de los datos missings Esto nos ayudará a
decidir la estrategia (borrar vs. llenar)

```{r}
# Contar NA por columna
na_por_columna <- colSums(is.na(data.vg))
print("NA por columna:")
print(na_por_columna)

# Porcentaje de NA por columna
porcentaje_na <- colMeans(is.na(data.vg)) * 100
print("Porcentaje de NA por columna:")
print(round(porcentaje_na, 2))

```

```{r}
length(unique(data.vg$Publisher))
filter(data.vg, Publisher==" ")

```

A año le faltan 271 valores (aprox 1,63%). Dado que este porcentajee es
muy pequeño, la estrategia más segura y sencilla es eliminar estas
filas. Intentar 'adivinar' (imputar) el año o la editorial podría
generar interferencias y llevar a conclusiones incorrectas. Queremos que
nuestro análisis se base en datos completos y precisos. Usaremos
.dropna() para eliminar las filas que contienen valores NaN en las
columnas especificadas.

Este reporte lo veré en GITHUB

```{r}
# DataFrame de ejemplo con missing values

print("DataFrame original:")
print(head(data.vg))
cat("Filas originales:", nrow(data.vg), "\n\n")

# Método 1: na.omit() - Elimina filas con cualquier NA
df_sin_na <- na.omit(data.vg)
print("Con na.omit():")
print(head(df_sin_na))
cat("Filas después de na.omit():", nrow(df_sin_na), "\n\n")

# Método 2: complete.cases() - Más control
df_completo <- data.vg[complete.cases(data.vg), ]
print("Con complete.cases():")
print(head(df_completo))
cat("Filas después de complete.cases():", nrow(df_completo), "\n")

```

```{r}
data.vg  <- data.vg[complete.cases(data.vg), ]
dim(data.vg)
```

# Tendencia Central

```{r}
summary(data.vg$Global_Sales)
```

```{r}
hist(filter(data.vg,Global_Sales < 5)$Global_Sales)
```

```{r}
set.seed(13)
N <- dim(data.vg)[1]
indices_muestra <- sample(1:N,200,replace = TRUE)
data.muestra<-data.vg[indices_muestra, ]
summary(data.muestra$Global_Sales)
```

```{r}
summary(data.vg$Global_Sales)

```

```{r}
dim(filter(data.vg, Global_Sales<2))
dim(data.vg)


dim( filter(data.vg, Global_Sales<2) )[1]  /  dim(data.vg)[1]
```

```{r}
data.vg.pobint <- filter(data.vg, Global_Sales<2)
summary(data.vg.pobint$Global_Sales)
```

```{r}
set.seed(10)
N <- dim(data.vg.pobint)[1]
indices_muestra <- sample(1:N,200,replace = TRUE)
data.muestra<-data.vg.pobint[indices_muestra, ]
summary(data.muestra$Global_Sales)
```

Graficos

```{r}

df <- data.vg.pobint

# Histograma agrupado por categoría
ggplot(df , aes(x = Global_Sales) ) + 
  geom_histogram(alpha = 0.4, bins = 20) + 
  labs(title = "Histograma de Ventas Globales de la poblacion de interes",
       x = "Ventas globales",
       y = "Frecuencia") +
  theme_minimal()
```

```{r}

df <- data.muestra

# Histograma agrupado por categoría
ggplot(df , aes(x = Global_Sales) ) + 
  geom_histogram(alpha = 0.4, bins = 20) + 
  labs(title = "Histograma de Ventas Globales de la muestra",
       x = "Ventas globales",
       y = "Frecuencia") +
  theme_minimal()
```

Población:

```{r}
summary(df)
```

Muestreo:

```{r}
set.seed(123)
indices_muestra <- sample(1:5,2,replace = FALSE)
df[indices_muestra,]
```

#TAREA

# Población de interés: ventas globales \< 2 millones

```{r}
data.vg.pobint <- filter(data.vg, Global_Sales < 2)
```

# Crear la nueva variable Peso_NA

```{r}
data.vg.pobint <- data.vg.pobint %>%
  mutate(Peso_NA = ifelse(Global_Sales > 0, NA_Sales / Global_Sales, NA))
```

# Verificar valores

```{r}
summary(data.vg.pobint$Peso_NA)
```

#Interpretación: #Valores cercanos a 1 → el juego depende casi
completamente del mercado norteamericano. #Valores cercanos a 0 → las
ventas provienen sobre todo de otras regiones.

```{r}
set.seed(101)
N <- nrow(data.vg.pobint)
```

# Muestra 1

```{r}
indices_m1 <- sample(1:N, 500, replace = TRUE)
muestra1 <- data.vg.pobint[indices_m1, ]
```

# Muestra 2

```{r}
set.seed(202)
indices_m2 <- sample(1:N, 500, replace = TRUE)
muestra2 <- data.vg.pobint[indices_m2, ]
```

# Estadísticas básicas

```{r}
summary(muestra1$Peso_NA)
summary(muestra2$Peso_NA)
```

#Interpretación: #Como las medias de la muestra 1 y 2 se asemejan a la
media poblacional de Peso_NA, esto demuestra que el muestreo es
representativo.

```{r}
summary(data.vg.pobint$Peso_NA)
```

# Comparar medias y desviaciones

```{r}
media_pob <- mean(data.vg.pobint$Peso_NA, na.rm = TRUE)
media_m1 <- mean(muestra1$Peso_NA, na.rm = TRUE)
media_m2 <- mean(muestra2$Peso_NA, na.rm = TRUE)
cat("Media población:", round(media_pob,3), "\n")
cat("Media muestra 1:", round(media_m1,3), "\n")
cat("Media muestra 2:", round(media_m2,3), "\n")
```

#Ya que las tres medias son similares, esto indica que el muestreo fue
realizado correctamente y la variable está bien distribuida.

# Graficar población

```{r}
ggplot(data.vg.pobint, aes(x = Peso_NA)) +
  geom_histogram(fill = "blue", color = "black", bins = 25, alpha = 0.6) +
  labs(title = "Distribución del Peso_NA en la población de interés",
       x = "Peso relativo de ventas en Norteamérica",
       y = "Frecuencia") +
  theme_minimal()
```

# Graficar muestras

```{r}
ggplot(muestra1, aes(x = Peso_NA)) +
  geom_histogram(fill = "orange", color = "black", bins = 25, alpha = 0.6) +
  labs(title = "Distribución del Peso_NA - Muestra 1",
       x = "Peso relativo de ventas en Norteamérica",
       y = "Frecuencia") +
  theme_minimal()

ggplot(muestra2, aes(x = Peso_NA)) +
  geom_histogram(fill = "green", color = "black", bins = 25, alpha = 0.6) +
  labs(title = "Distribución del Peso_NA - Muestra 2",
       x = "Peso relativo de ventas en Norteamérica",
       y = "Frecuencia") +
  theme_minimal()
```

#Observaciones y Conclusiones #En este análisis se estudió la variable
Peso_NA, que representa el porcentaje de ventas globales de videojuegos
que provienen de Norteamérica. Se trabajó con la población de juegos que
vendieron menos de 2 millones de copias. #Se tomaron dos muestras
aleatorias de 500 videojuegos y se compararon con la población. Se
observó que muchas ventas se concentran únicamente dentro o fuera de
Norteamérica (valores de 0 o 1 en Peso_NA). Esto indica que el mercado
está segmentado y que no todos los videojuegos se venden de forma
equilibrada en todas las regiones. #Las muestras reflejan bien el
comportamiento de la población, lo cual valida el proceso de muestreo y
permite obtener conclusiones representativas.
